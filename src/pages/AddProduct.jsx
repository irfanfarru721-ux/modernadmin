import React,{useEffect,useState} from 'react'; import API from '../services/api'; import {useNavigate} from 'react-router-dom'; export default function AddProduct(){ const nav=useNavigate(); const [form,setForm]=useState({name:'',price:'',vendor:'',category:'',description:''}); const [img,setImg]=useState(null); const [vendors,setV]=useState([]); const [cats,setC]=useState([]); useEffect(()=>{ API.get('/vendors').then(r=>setV(r.data)).catch(()=>{}); API.get('/categories').then(r=>setC(r.data)).catch(()=>{}); },[]); const submit=async(e)=>{ e.preventDefault(); const fd=new FormData(); fd.append('name',form.name); fd.append('price',form.price); fd.append('vendor',form.vendor); fd.append('category',form.category); fd.append('description',form.description); if(img) fd.append('image',img); await API.post('/admin/products',fd,{headers:{'Content-Type':'multipart/form-data'}}).catch(console.error); nav('/products'); }; return (<div><h1>Add Product</h1><form className='card' onSubmit={submit}><input placeholder='Name' value={form.name} onChange={e=>setForm({...form,name:e.target.value})} required/><input placeholder='Price' type='number' value={form.price} onChange={e=>setForm({...form,price:e.target.value})} required/><select value={form.vendor} onChange={e=>setForm({...form,vendor:e.target.value})}><option value=''>Select vendor</option>{vendors.map(v=>(<option key={v._id} value={v._id}>{v.name}</option>))}</select><select value={form.category} onChange={e=>setForm({...form,category:e.target.value})}><option value=''>Select category</option>{cats.map(c=>(<option key={c._id} value={c._id}>{c.name}</option>))}</select><textarea placeholder='Description' value={form.description} onChange={e=>setForm({...form,description:e.target.value})}></textarea><input type='file' accept='image/*' onChange={e=>setImg(e.target.files[0])}/><button className='btn' type='submit'>Add</button></form></div>); }
